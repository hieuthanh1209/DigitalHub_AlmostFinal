@model DigitalHub.Models.OrderPro
@{
    ViewBag.Title = "Order Details";
    Layout = "~/Views/Shared/_AdminMasterLayout.cshtml";
}

<div class="container my-5">
    <h2>Order Details - ID: @Model.ID</h2>

    <!-- Kiểm tra và hiển thị tên khách hàng -->
    <p><strong>Customer Name:</strong> @(Model.Customer != null ? Model.Customer.NameCus : "N/A")</p>

    <!-- Kiểm tra và hiển thị ngày đặt hàng -->
    <p><strong>Order Date:</strong> @(Model.DateOrder.HasValue ? Model.DateOrder.Value.ToString("dd/MM/yyyy") : "N/A")</p>

    <h4>Order Items</h4>
    <table class="table table-bordered">
        <thead>
            <tr>
                <th>Product Name</th>
                <th>Quantity</th>
                <th>Unit Price</th>
                <th>Total</th>
                <th>Address</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model.OrderDetails)
            {
                <tr>
                    <!-- Kiểm tra và hiển thị tên sản phẩm -->
                    <td>@(item.Product != null ? item.Product.NamePro : "Unknown Product")</td>
                    <td>@item.Quantity</td>

                    <!-- Kiểm tra và hiển thị giá đơn vị -->
                    <td>@(item.UnitPrice.HasValue ? item.UnitPrice.Value.ToString("N0") : "0") ₫</td>

                    <!-- Tính tổng và hiển thị -->
                    @{
                        var total = (item.Quantity ?? 0) * (item.UnitPrice ?? 0m);
                    }
                    <td>@total.ToString("N0") ₫</td>
                    <td>@(item.OrderPro.AddressDeliverry)</td>

                </tr>
            }
        </tbody>
    </table>

    <!-- Display payment confirmation button if the order is not yet paid -->
    @if (!Model.IsPaid)
    {
        using (Html.BeginForm("ConfirmPayment", "InvoiceManager", FormMethod.Post))
        {
            @Html.AntiForgeryToken()
            <input type="hidden" name="id" value="@Model.ID" />
            <button type="submit" class="btn btn-success">Confirm Payment</button>
        }
    }
    else
    {
        <p class="text-success">Order has been confirmed as paid.</p>
    }

    <a href="@Url.Action("Orders", "InvoiceManager")" class="btn btn-secondary">Back to Orders</a>
</div>
